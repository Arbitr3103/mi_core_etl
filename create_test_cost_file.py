#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
"""

import pandas as pd
import os

def create_test_cost_file():
    """–°–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç–∏"""
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ - –≤–∫–ª—é—á–∞–µ–º —Ç–æ–≤–∞—Ä –•–ª–æ–ø—å—è_–ù–¢–í700 —Å —Å–µ–±–µ—Å—Ç–æ–∏–º–æ—Å—Ç—å—é 103.818
    test_data = [
        {
            '–±–∞—Ä–∫–æ–¥': '4607034648725',  # –®—Ç—Ä–∏—Ö–∫–æ–¥ –¥–ª—è –•–ª–æ–ø—å—è_–ù–¢–í700
            '–∞—Ä—Ç–∏–∫—É–ª': '–•–ª–æ–ø—å—è_–ù–¢–í700',
            '–°–° –±–µ–∑ –ù–î–°': 103.818
        },
        {
            '–±–∞—Ä–∫–æ–¥': '1234567890123',
            '–∞—Ä—Ç–∏–∫—É–ª': 'TEST_PRODUCT_001',
            '–°–° –±–µ–∑ –ù–î–°': 50.50
        },
        {
            '–±–∞—Ä–∫–æ–¥': '9876543210987',
            '–∞—Ä—Ç–∏–∫—É–ª': 'TEST_PRODUCT_002', 
            '–°–° –±–µ–∑ –ù–î–°': 75.25
        }
    ]
    
    # –°–æ–∑–¥–∞–µ–º DataFrame
    df = pd.DataFrame(test_data)
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É
    base_dir = os.path.dirname(os.path.abspath(__file__))
    file_path = os.path.join(base_dir, 'data', 'cost_price.xlsx')
    
    # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
    os.makedirs(os.path.dirname(file_path), exist_ok=True)
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Excel
    df.to_excel(file_path, index=False, engine='openpyxl')
    
    print(f"‚úÖ –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª: {file_path}")
    print("üìä –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:")
    print(df.to_string(index=False))
    
    return file_path

if __name__ == "__main__":
    create_test_cost_file()
