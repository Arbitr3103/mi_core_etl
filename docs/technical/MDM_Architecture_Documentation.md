# Документация архитектуры системы MDM

## Содержание

1. [Обзор архитектуры](#обзор-архитектуры)
2. [Компоненты системы](#компоненты-системы)
3. [База данных](#база-данных)
4. [API и интеграции](#api-и-интеграции)
5. [Безопасность](#безопасность)
6. [Производительность](#производительность)
7. [Мониторинг](#мониторинг)

## Обзор архитектуры

### Высокоуровневая архитектура

Система MDM построена по модульной архитектуре с четким разделением ответственности:

```
┌─────────────────────────────────────────────────────────────┐
│                    Presentation Layer                        │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │ Web UI      │  │ REST API    │  │ Admin Interface     │  │
│  │ (PHP/HTML)  │  │ (PHP)       │  │ (PHP)               │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                    Business Logic Layer                     │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │ MDM Core    │  │ Matching    │  │ Data Quality        │  │
│  │ Services    │  │ Engine      │  │ Services            │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                    Data Access Layer                        │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │ Repository  │  │ ETL         │  │ Cache Layer         │  │
│  │ Pattern     │  │ Services    │  │ (Redis)             │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                    Data Storage Layer                       │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │ MySQL       │  │ File        │  │ External APIs       │  │
│  │ Database    │  │ Storage     │  │ (Ozon, WB)          │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### Принципы архитектуры

- **Модульность** - четкое разделение функциональности по модулям
- **Масштабируемость** - возможность горизонтального масштабирования
- **Надежность** - отказоустойчивость и восстановление после сбоев
- **Безопасность** - многоуровневая защита данных и доступа
- **Производительность** - оптимизация для работы с большими объемами данных

## Компоненты системы

### MDM Core Services

**Назначение:** Основные сервисы для управления мастер-данными

**Ключевые классы:**

- `ProductsService` - управление мастер-товарами
- `VerificationService` - обработка верификации
- `DataQualityService` - контроль качества данных
- `StatisticsService` - расчет метрик и статистики

**Расположение:** `/src/MDM/Services/`

### Matching Engine

**Назначение:** Автоматическое сопоставление товаров

**Алгоритмы сопоставления:**

1. **Exact Match** - точное совпадение по SKU/штрихкоду
2. **Fuzzy Matching** - нечеткое сравнение названий
3. **Brand + Category** - сопоставление по бренду и категории
4. **Attribute Similarity** - сравнение атрибутов

**Ключевые классы:**

- `MatchingService` - основной сервис сопоставления
- `FuzzyMatcher` - алгоритмы нечеткого поиска
- `ScoreCalculator` - расчет уверенности сопоставления

### ETL Pipeline

**Назначение:** Извлечение, трансформация и загрузка данных

**Компоненты:**

- **Extractors** - извлечение данных из источников
- **Transformers** - очистка и стандартизация данных
- **Loaders** - загрузка в MDM систему
- **Orchestrator** - управление ETL процессами

**Расположение:** `/src/ETL/`

### Web Interface

**Назначение:** Пользовательский интерфейс системы

**Основные контроллеры:**

- `DashboardController` - главная панель
- `VerificationController` - интерфейс верификации
- `ProductsController` - управление товарами
- `ReportsController` - отчеты и аналитика

**Технологии:**

- PHP 7.4+ для серверной логики
- HTML5/CSS3/JavaScript для клиентской части
- Bootstrap для адаптивного дизайна
