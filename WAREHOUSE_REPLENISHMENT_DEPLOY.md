# üöÄ –î–µ–ø–ª–æ–π —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é —Å–∫–ª–∞–¥–æ–≤

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–í—Å—è —Å–∏—Å—Ç–µ–º–∞ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ. –¢–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω.

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è

```bash
./deploy_warehouse_replenishment.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

-   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
-   ‚úÖ –°–æ–∑–¥–∞—Å—Ç –±—ç–∫–∞–ø –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
-   ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç —Ñ–∞–π–ª—ã –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω
-   ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞
-   ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å API

### –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ –¥–∞—à–±–æ—Ä–¥—ã

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:

**Warehouse Dashboard (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∫–ª–∞–¥–æ–≤):**

```
https://www.market-mi.ru/warehouse_dashboard.html
```

**Replenishment Dashboard (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é):**

```
https://www.market-mi.ru/html/replenishment_dashboard.php
```

---

## –ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ –≤ –¥–µ–ø–ª–æ–π

### 1. Warehouse Dashboard (`warehouse_dashboard.html`)

-   –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ —Å–∫–ª–∞–¥–∞–º
-   KPI –º–µ—Ç—Ä–∏–∫–∏ (–æ–±—â–∏–µ –æ—Å—Ç–∞—Ç–∫–∏, –ø—Ä–æ–¥–∞–∂–∏, —Ç—Ä–µ–±—É—é—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è)
-   –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É —Å–∫–ª–∞–¥–∞
-   –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–∫–ª–∞–¥–æ–≤ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
-   –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–∫–∞–∑—É

### 2. Warehouse Dashboard API (`api/warehouse-dashboard.php`)

Endpoints:

-   `?action=dashboard` - –¥–∞–Ω–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥–∞
-   `?action=warehouses` - —Å–ø–∏—Å–æ–∫ —Å–∫–ª–∞–¥–æ–≤
-   `?action=clusters` - –∫–ª–∞—Å—Ç–µ—Ä—ã —Å–∫–ª–∞–¥–æ–≤
-   `?action=export` - —ç–∫—Å–ø–æ—Ä—Ç –≤ CSV

### 3. Replenishment Dashboard (`html/replenishment_dashboard.php`)

-   –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é
-   –†–∞—Å—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ ADS (Average Daily Sales)
-   –§–∏–ª—å—Ç—Ä—ã –ø–æ —Ç–æ–≤–∞—Ä–∞–º, —Å–∫–ª–∞–¥–∞–º, —Å—Ç–∞—Ç—É—Å—É
-   –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—Å–µ–º –∫–æ–ª–æ–Ω–∫–∞–º
-   –ü–∞–≥–∏–Ω–∞—Ü–∏—è
-   –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel

### 4. Replenishment API (`api/replenishment.php`)

Endpoints:

-   `?action=recommendations` - –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
-   `?action=calculate` - –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
-   `?action=report` - –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
-   `?action=config` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã
-   `?action=status` - —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API

```bash
# Warehouse Dashboard API
curl "https://www.market-mi.ru/api/warehouse-dashboard.php?action=dashboard&limit=1"

# Replenishment API
curl "https://www.market-mi.ru/api/replenishment.php?action=status"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

1. **Warehouse Dashboard:**

    - –û—Ç–∫—Ä–æ–π—Ç–µ https://www.market-mi.ru/warehouse_dashboard.html
    - –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ —Å–∫–ª–∞–¥–æ–≤
    - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã (–í—Å–µ —Å–∫–ª–∞–¥—ã, –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ, –ù–∏–∑–∫–∏–µ, –∏ —Ç.–¥.)

2. **Replenishment Dashboard:**
    - –û—Ç–∫—Ä–æ–π—Ç–µ https://www.market-mi.ru/html/replenishment_dashboard.php
    - –î–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è —Ç–∞–±–ª–∏—Ü–∞ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
    - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
    - –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç –≤ Excel

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

–í Replenishment Dashboard –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏":

-   **–ü–µ—Ä–∏–æ–¥ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è** (–¥–Ω–∏): –°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –∑–∞–ø–∞—Å–∞ –Ω—É–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å
-   **–°—Ç—Ä–∞—Ö–æ–≤–æ–π –∑–∞–ø–∞—Å** (–¥–Ω–∏): –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø–∞—Å –Ω–∞ —Å–ª—É—á–∞–π –∑–∞–¥–µ—Ä–∂–µ–∫
-   **–ü–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–¥–∞–∂** (–¥–Ω–∏): –ó–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–¥–∞–∂–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ ADS
-   **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π ADS**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ADS –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### Warehouse Dashboard –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:

-   `warehouse_sales_metrics` - –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–¥–∞–∂ –ø–æ —Å–∫–ª–∞–¥–∞–º
-   `dim_products` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤
-   `inventory` - –æ—Å—Ç–∞—Ç–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤

### Replenishment System –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:

-   `replenishment_recommendations` - —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é
-   `replenishment_config` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
-   `replenishment_calculations` - –∏—Å—Ç–æ—Ä–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤

---

## –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –±—ç–∫–∞–ø —Å–æ—Ö—Ä–∞–Ω–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
ssh vladimir@178.72.129.61

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –±—ç–∫–∞–ø—ã
ls -la /var/www/backups/

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞
sudo cp /var/www/backups/warehouse_replenishment_backup_YYYYMMDD_HHMMSS/* /var/www/market-mi.ru/
```

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500 –æ—à–∏–±–∫—É

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh vladimir@178.72.129.61
sudo tail -f /var/log/nginx/error.log
sudo tail -f /var/log/php8.1-fpm.log
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
ssh vladimir@178.72.129.61
psql -U mi_core_user -d mi_core_db -c "SELECT COUNT(*) FROM dim_products;"
```

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞—à–±–æ—Ä–¥ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
ssh vladimir@178.72.129.61
ls -la /var/www/market-mi.ru/warehouse_dashboard.html
ls -la /var/www/market-mi.ru/html/replenishment_dashboard.php
```

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–∞—à–±–æ—Ä–¥–æ–≤
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞—Å—á–µ—Ç–∞ –ø–æ–¥ –≤–∞—à–∏ –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
4. ‚úÖ –û–±—É—á–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ä–∞–±–æ—Ç–µ —Å —Å–∏—Å—Ç–µ–º–æ–π
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Å—á–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (cron)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ—Å—á–µ—Ç–∞

–î–æ–±–∞–≤—å—Ç–µ –≤ crontab –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –ü–µ—Ä–µ—Å—á–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 6:00
0 6 * * * curl -X POST "https://www.market-mi.ru/api/replenishment.php?action=calculate"
```

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

-   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
-   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
-   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

---

**–ì–æ—Ç–æ–≤–æ! –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—é —Å–∫–ª–∞–¥–æ–≤ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞! üéâ**
