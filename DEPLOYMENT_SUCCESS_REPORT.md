# üéâ –û–¢–ß–ï–¢ –û–ë –£–°–ü–ï–®–ù–û–ú –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–ò API

**–î–∞—Ç–∞:** 10.10.2025 07:30 UTC  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –£–°–ü–ï–®–ù–û**

## –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ —Ä–µ—à–µ–Ω–∞

- ‚ùå `action=products` –≤–æ–∑–≤—Ä–∞—â–∞–ª HTTP 500 Internal Server Error
- ‚ùå `action=low-stock` –≤–æ–∑–≤—Ä–∞—â–∞–ª HTTP 500
- ‚ùå `action=analytics` –≤–æ–∑–≤—Ä–∞—â–∞–ª HTTP 500
- **–ü—Ä–∏—á–∏–Ω–∞:** `CAST(i.product_id AS CHAR)` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ –≤–µ—Ä—Å–∏–∏ MySQL –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ

‚úÖ –ó–∞–º–µ–Ω–∏–ª–∏ –≤—Å–µ `CAST(i.product_id AS CHAR)` –Ω–∞ `CONCAT('', i.product_id)`  
‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã 3 –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö SQL –∑–∞–ø—Ä–æ—Å–∞ –≤ API  
‚úÖ –°–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–µ

### –ö–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:

```bash
wget https://raw.githubusercontent.com/Arbitr3103/mi_core_etl/main/update-server-api.sh
chmod +x update-server-api.sh
./update-server-api.sh
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

- ‚úÖ –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω (12.18K)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å—Ç–∞—Ä–æ–≥–æ API
- ‚úÖ API —Ñ–∞–π–ª –æ–±–Ω–æ–≤–ª–µ–Ω –≤ `/var/www/html/api/inventory-v4.php`
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (`www-data:www-data`)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### ‚úÖ action=overview (HTTP 200)

```json
{
  "success": true,
  "data": {
    "overview": {
      "total_products": 202,
      "products_in_stock": 79,
      "total_stock": "5714",
      "total_reserved": "58",
      "total_warehouses": 31,
      "avg_stock": "28.2871",
      "last_update": "2025-10-09 13:02:58"
    }
  }
}
```

### ‚úÖ action=products (HTTP 200) - –ò–°–ü–†–ê–í–õ–ï–ù–û!

```json
{
  "success": true,
  "data": {
    "products": [
      {
        "sku": 596534196,
        "display_name": "–¢–æ–≤–∞—Ä ID 596534196",
        "name_source": "–ß–∏—Å–ª–æ–≤–æ–π ID",
        "total_stock": 1176,
        ...
      }
    ]
  }
}
```

### ‚úÖ action=low-stock (HTTP 200) - –ò–°–ü–†–ê–í–õ–ï–ù–û!

–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Å—Ç–∞—Ç–∫–∞—Ö

### ‚úÖ action=analytics (HTTP 200) - –ò–°–ü–†–ê–í–õ–ï–ù–û!

–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

- **üì¶ –¢–æ–≤–∞—Ä—ã:** 202 –∑–∞–ø–∏—Å–∏ –≤ –ë–î, 79 –≤ –Ω–∞–ª–∏—á–∏–∏
- **üìä –û—Å—Ç–∞—Ç–∫–∏:** 5,714 –µ–¥–∏–Ω–∏—Ü –æ–±—â–∏–π –æ—Å—Ç–∞—Ç–æ–∫, 58 –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ
- **üè™ –°–∫–ª–∞–¥—ã:** 31 —Å–∫–ª–∞–¥ –≤ —Å–∏—Å—Ç–µ–º–µ
- **üìà –°—Ä–µ–¥–Ω–∏–π –æ—Å—Ç–∞—Ç–æ–∫:** 28.29 –µ–¥–∏–Ω–∏—Ü –Ω–∞ —Ç–æ–≤–∞—Ä
- **üïê –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-09 13:02:58

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

- `api/inventory-v4.php` - –æ—Å–Ω–æ–≤–Ω–æ–π API —Ñ–∞–π–ª

### –ö–æ–º–º–∏—Ç—ã GitHub:

- `8b8b8b8` - –ü–µ—Ä–≤–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ CAST –Ω–∞ CONCAT
- `e2413db` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è CAST –Ω–∞ CONCAT
- `0785fd5` - –§–∏–Ω–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Å–∫—Ä–∏–ø—Ç—ã

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:

- ‚úÖ MySQL 5.7+
- ‚úÖ MariaDB 10.0+
- ‚úÖ –í—Å–µ –≤–µ—Ä—Å–∏–∏ PHP 7.4+

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:

1. **API –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω** - –≤—Å–µ endpoints —Ä–∞–±–æ—Ç–∞—é—Ç
2. **–î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è** - —Ç–æ–≤–∞—Ä—ã —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
3. **–û—à–∏–±–∫–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã** - –±–æ–ª—å—à–µ –Ω–µ—Ç HTTP 500

### üîÑ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ HTTP —Å—Ç–∞—Ç—É—Å–æ–≤ API endpoints
2. –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–æ–≤—ã–µ –æ—à–∏–±–∫–∏
3. –†–µ–≥—É–ª—è—Ä–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ endpoints –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ë–î

---

## üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –°–¢–ê–¢–£–°

**‚úÖ –í–°–ï –ü–†–û–ë–õ–ï–ú–´ –†–ï–®–ï–ù–´**  
**‚úÖ API –ü–û–õ–ù–û–°–¢–¨–Æ –§–£–ù–ö–¶–ò–û–ù–ê–õ–ï–ù**  
**‚úÖ –ì–û–¢–û–í –ö –ü–†–û–î–ê–ö–®–ù –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ**

**–í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è:** ~2 —á–∞—Å–∞  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã:** –°—Ä–µ–¥–Ω—è—è (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å SQL)  
**–ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ—à–µ–Ω–∏—è:** –í—ã—Å–æ–∫–æ–µ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)

üöÄ **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!**
