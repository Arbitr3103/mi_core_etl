# Requirements Document - Warehouse Dashboard

## Introduction

Дашборд для менеджеров по управлению остатками на складах Ozon с расчетом потребности в пополнении на основе реальных продаж.

## Glossary

-   **System** - Warehouse Dashboard (дашборд складских остатков)
-   **Manager** - менеджер по управлению остатками
-   **Active Product** - товар с продажами за последний месяц ИЛИ с остатками > 0
-   **Warehouse** - конкретный склад Ozon (например, "АДЫГЕЙСК_РФЦ")
-   **Cluster** - группа складов (например, "Юг", "Урал")
-   **Replenishment Need** - потребность в пополнении (разница между целевым запасом и текущими остатками)
-   **Target Stock** - целевой запас на месяц (среднесуточные продажи × 30 дней)
-   **Daily Sales** - среднесуточные продажи за последние 28 дней
-   **Liquidity Status** - статус ликвидности (дефицит, норма, избыток)
-   **Days of Stock** - на сколько дней хватит текущих остатков

## Requirements

### Requirement 1: Фильтрация активных товаров

**User Story:** Как менеджер, я хочу видеть только активные товары, чтобы не тратить время на неактуальные позиции

#### Acceptance Criteria

1. WHEN Manager открывает дашборд, THE System SHALL отображать только товары, которые имеют продажи за последние 30 дней ИЛИ текущие остатки больше нуля
2. WHEN товар не имеет продаж за последние 30 дней И остатки равны нулю, THE System SHALL исключать этот товар из отображения
3. WHEN Manager применяет фильтр "Показать все товары", THE System SHALL отображать все товары включая неактивные

### Requirement 2: Группировка по складам

**User Story:** Как менеджер, я хочу видеть остатки по конкретным складам, а не по кластерам, чтобы точно знать где нужно пополнение

#### Acceptance Criteria

1. WHEN Manager просматривает дашборд, THE System SHALL отображать данные с группировкой по конкретным складам (например, "АДЫГЕЙСК*РФЦ", "Ростов*на*Дону*РФЦ")
2. WHEN товар находится на нескольких складах, THE System SHALL отображать отдельную строку для каждого склада
3. WHEN Manager выбирает склад из фильтра, THE System SHALL отображать только товары на выбранном складе
4. THE System SHALL отображать название кластера рядом с названием склада для контекста

### Requirement 3: Расчет потребности в пополнении

**User Story:** Как менеджер, я хочу видеть сколько товара нужно заказать для каждого склада, чтобы обеспечить запас на месяц

#### Acceptance Criteria

1. WHEN System рассчитывает потребность в пополнении, THE System SHALL использовать формулу: (среднесуточные продажи × 30) - (доступно к продаже + в пути)
2. WHEN среднесуточные продажи равны нулю, THE System SHALL устанавливать потребность в пополнении равной нулю
3. WHEN текущие остатки превышают целевой запас, THE System SHALL отображать потребность в пополнении как ноль
4. THE System SHALL отображать потребность в пополнении с точностью до целых единиц
5. THE System SHALL выделять цветом товары с высокой потребностью в пополнении (> 50% от целевого запаса)

### Requirement 4: Расчет среднесуточных продаж

**User Story:** Как менеджер, я хочу видеть среднесуточные продажи по каждому товару на каждом складе, чтобы понимать динамику спроса

#### Acceptance Criteria

1. WHEN System рассчитывает среднесуточные продажи, THE System SHALL использовать данные за последние 28 дней
2. WHEN товар был в наличии не все 28 дней, THE System SHALL делить количество продаж на количество дней когда товар был в наличии
3. WHEN товар не имел продаж за период, THE System SHALL отображать среднесуточные продажи как 0
4. THE System SHALL отображать среднесуточные продажи с точностью до двух знаков после запятой

### Requirement 5: Расчет ликвидности в днях

**User Story:** Как менеджер, я хочу видеть на сколько дней хватит текущих остатков, чтобы планировать поставки

#### Acceptance Criteria

1. WHEN System рассчитывает ликвидность в днях, THE System SHALL использовать формулу: доступно к продаже / среднесуточные продажи
2. WHEN среднесуточные продажи равны нулю, THE System SHALL отображать ликвидность как "∞" (бесконечность)
3. WHEN ликвидность меньше 7 дней, THE System SHALL отмечать товар как "Критический дефицит"
4. WHEN ликвидность от 7 до 14 дней, THE System SHALL отмечать товар как "Низкий запас"
5. WHEN ликвидность от 15 до 45 дней, THE System SHALL отмечать товар как "Нормальный запас"
6. WHEN ликвидность больше 45 дней, THE System SHALL отмечать товар как "Избыточный запас"

### Requirement 6: Отображение метрик Ozon

**User Story:** Как менеджер, я хочу видеть все ключевые метрики Ozon для каждого товара, чтобы принимать обоснованные решения

#### Acceptance Criteria

1. THE System SHALL отображать следующие метрики для каждого товара на каждом складе:

    - Доступно к продаже
    - Готовим к продаже
    - В заявках на поставку
    - В поставках в пути
    - Проходят проверку
    - Возвращаются от покупателей
    - Истекает срок годности
    - Брак, доступный к вывозу

2. WHEN метрика равна нулю, THE System SHALL отображать "0" или скрывать метрику (настраивается)
3. WHEN метрика "Истекает срок годности" больше нуля, THE System SHALL выделять её красным цветом
4. WHEN метрика "Брак" больше нуля, THE System SHALL выделять её оранжевым цветом

### Requirement 7: Статус ликвидности

**User Story:** Как менеджер, я хочу видеть статус ликвидности товара одним взглядом, чтобы быстро определить проблемные позиции

#### Acceptance Criteria

1. THE System SHALL рассчитывать статус ликвидности на основе соотношения спроса и остатков
2. WHEN ликвидность < 7 дней, THE System SHALL присваивать статус "Дефицит" с красным индикатором
3. WHEN ликвидность 7-14 дней, THE System SHALL присваивать статус "Низкий запас" с желтым индикатором
4. WHEN ликвидность 15-45 дней, THE System SHALL присваивать статус "Норма" с зеленым индикатором
5. WHEN ликвидность > 45 дней, THE System SHALL присваивать статус "Избыток" с синим индикатором

### Requirement 8: Дни без продаж

**User Story:** Как менеджер, я хочу видеть сколько дней подряд товар был без продаж, чтобы выявлять проблемные позиции

#### Acceptance Criteria

1. THE System SHALL рассчитывать количество последовательных дней без продаж
2. WHEN товар имел продажи сегодня или вчера, THE System SHALL отображать "0 дней"
3. WHEN товар не имел продаж 7+ дней, THE System SHALL выделять метрику желтым цветом
4. WHEN товар не имел продаж 14+ дней, THE System SHALL выделять метрику красным цветом

### Requirement 9: Фильтрация и сортировка

**User Story:** Как менеджер, я хочу фильтровать и сортировать товары по различным критериям, чтобы быстро находить нужную информацию

#### Acceptance Criteria

1. THE System SHALL предоставлять фильтры по:

    - Складу
    - Кластеру
    - Статусу ликвидности
    - Наличию потребности в пополнении
    - Категории товара

2. THE System SHALL предоставлять сортировку по:

    - Потребности в пополнении (по убыванию)
    - Ликвидности в днях (по возрастанию)
    - Среднесуточным продажам (по убыванию)
    - Названию товара (по алфавиту)
    - Дням без продаж (по убыванию)

3. WHEN Manager применяет несколько фильтров, THE System SHALL применять их с логикой AND

### Requirement 10: Экспорт данных

**User Story:** Как менеджер, я хочу экспортировать данные дашборда, чтобы делиться ими с коллегами или анализировать в Excel

#### Acceptance Criteria

1. THE System SHALL предоставлять кнопку "Экспорт в CSV"
2. WHEN Manager нажимает "Экспорт в CSV", THE System SHALL генерировать CSV файл со всеми отображаемыми данными
3. THE System SHALL включать в экспорт все примененные фильтры
4. THE System SHALL называть файл по шаблону: "warehouse_dashboard_YYYY-MM-DD.csv"

### Requirement 11: Обновление данных

**User Story:** Как менеджер, я хочу видеть актуальные данные, чтобы принимать решения на основе свежей информации

#### Acceptance Criteria

1. THE System SHALL отображать время последнего обновления данных
2. THE System SHALL предоставлять кнопку "Обновить данные"
3. WHEN Manager нажимает "Обновить данные", THE System SHALL загружать свежие данные из базы данных
4. THE System SHALL автоматически обновлять данные каждые 5 минут (настраивается)

### Requirement 12: Производительность

**User Story:** Как менеджер, я хочу чтобы дашборд загружался быстро, чтобы не тратить время на ожидание

#### Acceptance Criteria

1. WHEN Manager открывает дашборд, THE System SHALL загружать и отображать данные в течение 2 секунд
2. WHEN Manager применяет фильтр, THE System SHALL обновлять отображение в течение 500 миллисекунд
3. THE System SHALL использовать пагинацию для отображения более 100 товаров
4. THE System SHALL кэшировать расчеты на стороне сервера на 5 минут

---

## Summary

Дашборд предоставляет менеджерам полную картину остатков на складах Ozon с автоматическим расчетом потребности в пополнении на основе реальных продаж. Система фокусируется только на активных товарах и предоставляет детализацию до уровня конкретных складов.
