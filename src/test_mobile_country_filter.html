<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ —Å—Ç—Ä–∞–Ω–µ</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- –°—Ç–∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞ -->
    <link href="css/country-filter.css" rel="stylesheet" />

    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background-color: #f8f9fa;
        -webkit-text-size-adjust: 100%;
        -webkit-tap-highlight-color: transparent;
      }

      .test-header {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        padding: 2rem 0;
        margin-bottom: 2rem;
      }

      .test-section {
        background: white;
        border-radius: 0.5rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .test-results {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 0.375rem;
        padding: 1rem;
        margin-top: 1rem;
        font-family: "Courier New", monospace;
        font-size: 0.85rem;
        max-height: 400px;
        overflow-y: auto;
      }

      .status-badge {
        display: inline-block;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
      }

      .status-passed {
        background-color: #d4edda;
        color: #155724;
      }

      .status-failed {
        background-color: #f8d7da;
        color: #721c24;
      }

      .status-warning {
        background-color: #fff3cd;
        color: #856404;
      }

      .test-controls {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
        flex-wrap: wrap;
      }

      .test-controls .btn {
        flex: 1;
        min-width: 150px;
      }

      .device-simulator {
        border: 2px solid #6c757d;
        border-radius: 1rem;
        padding: 1rem;
        background: #fff;
        margin: 1rem 0;
        position: relative;
      }

      .device-simulator::before {
        content: attr(data-device);
        position: absolute;
        top: -0.75rem;
        left: 1rem;
        background: #6c757d;
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 0.25rem;
        font-size: 0.75rem;
        font-weight: 600;
      }

      .performance-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
      }

      .performance-card {
        background: #e3f2fd;
        border: 1px solid #bbdefb;
        border-radius: 0.375rem;
        padding: 1rem;
        text-align: center;
      }

      .performance-value {
        font-size: 1.5rem;
        font-weight: 600;
        color: #1976d2;
        margin-bottom: 0.5rem;
      }

      .performance-label {
        font-size: 0.85rem;
        color: #666;
      }

      .touch-test-area {
        background: linear-gradient(45deg, #fff3cd, #ffeaa7);
        border: 2px dashed #ffc107;
        border-radius: 0.5rem;
        padding: 2rem;
        text-align: center;
        margin: 1rem 0;
        min-height: 100px;
        display: flex;
        align-items: center;
        justify-content: center;
        user-select: none;
        touch-action: manipulation;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .touch-test-area:active {
        transform: scale(0.98);
        background: linear-gradient(45deg, #d4edda, #a8e6cf);
        border-color: #28a745;
      }

      .console-output {
        background: #1e1e1e;
        color: #f8f8f2;
        border-radius: 0.375rem;
        padding: 1rem;
        font-family: "Courier New", monospace;
        font-size: 0.8rem;
        max-height: 300px;
        overflow-y: auto;
        margin-top: 1rem;
      }

      .console-output .log-entry {
        margin-bottom: 0.25rem;
        padding: 0.25rem 0;
        border-bottom: 1px solid #333;
      }

      .console-output .log-entry:last-child {
        border-bottom: none;
      }

      .console-output .log-success {
        color: #a6e22e;
      }

      .console-output .log-error {
        color: #f92672;
      }

      .console-output .log-warning {
        color: #fd971f;
      }

      .console-output .log-info {
        color: #66d9ef;
      }

      @media (max-width: 768px) {
        .test-controls {
          flex-direction: column;
        }

        .test-controls .btn {
          min-width: auto;
        }

        .performance-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="test-header">
      <div class="container">
        <h1 class="mb-0">üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏</h1>
        <p class="mb-0 mt-2">
          –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ —Å—Ç—Ä–∞–Ω–µ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
          —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        </p>
      </div>
    </div>

    <div class="container">
      <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞–º–∏ -->
      <div class="test-section">
        <h2>üéÆ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞–º–∏</h2>
        <div class="test-controls">
          <button id="run-all-tests" class="btn btn-primary">
            –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
          </button>
          <button id="run-mobile-adaptation" class="btn btn-secondary">
            –¢–µ—Å—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
          </button>
          <button id="run-touch-usability" class="btn btn-secondary">
            –¢–µ—Å—Ç touch UX
          </button>
          <button id="run-loading-optimization" class="btn btn-secondary">
            –¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
          </button>
          <button id="clear-results" class="btn btn-outline-danger">
            –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
          </button>
        </div>

        <div class="alert alert-info">
          <strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</strong>
          <ul class="mb-0 mt-2">
            <li>–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞</li>
            <li>–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –∏ —Ä–∞–∑–º–µ—Ä–∞—Ö —ç–∫—Ä–∞–Ω–∞</li>
            <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –≤ portrait –∏ landscape –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è—Ö</li>
            <li>–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –∏ –ø–ª–∞–≤–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–π</li>
          </ul>
        </div>
      </div>

      <!-- –°–∏–º—É–ª—è—Ç–æ—Ä—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
      <div class="test-section">
        <h2>üì± –°–∏–º—É–ª—è—Ç–æ—Ä—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤</h2>

        <div class="row">
          <div class="col-md-6">
            <div class="device-simulator" data-device="iPhone SE (375x667)">
              <div id="iphone-se-test"></div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="device-simulator" data-device="iPad (768x1024)">
              <div id="ipad-test"></div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6">
            <div class="device-simulator" data-device="Android Phone (414x896)">
              <div id="android-phone-test"></div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="device-simulator" data-device="Small Screen (320x568)">
              <div id="small-screen-test"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- –¢–µ—Å—Ç touch –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è -->
      <div class="test-section">
        <h2>üëÜ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç touch</h2>

        <div class="touch-test-area" id="interactive-touch-test">
          –ö–æ—Å–Ω–∏—Ç–µ—Å—å –∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ –∑–¥–µ—Å—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç–∏
        </div>

        <div class="row">
          <div class="col-md-6">
            <h5>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ touch:</h5>
            <ul id="touch-stats">
              <li>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Å–∞–Ω–∏–π: <span id="touch-count">0</span></li>
              <li>
                –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞: <span id="avg-response-time">-</span>–º—Å
              </li>
              <li>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∫–∞—Å–∞–Ω–∏–µ: <span id="last-touch-time">-</span></li>
            </ul>
          </div>

          <div class="col-md-6">
            <h5>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:</h5>
            <ul id="device-info">
              <li>User Agent: <span id="user-agent">-</span></li>
              <li>Touch –ø–æ–¥–¥–µ—Ä–∂–∫–∞: <span id="touch-support">-</span></li>
              <li>–†–∞–∑–º–µ—Ä —ç–∫—Ä–∞–Ω–∞: <span id="screen-dimensions">-</span></li>
              <li>Pixel Ratio: <span id="pixel-ratio">-</span></li>
            </ul>
          </div>
        </div>
      </div>

      <!-- –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ -->
      <div class="test-section">
        <h2>üìä –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>

        <div class="performance-grid">
          <div class="performance-card">
            <div class="performance-value" id="init-time">-</div>
            <div class="performance-label">–í—Ä–µ–º—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–º—Å)</div>
          </div>

          <div class="performance-card">
            <div class="performance-value" id="first-load-time">-</div>
            <div class="performance-label">–ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–º—Å)</div>
          </div>

          <div class="performance-card">
            <div class="performance-value" id="cache-load-time">-</div>
            <div class="performance-label">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –∫—ç—à–∞ (–º—Å)</div>
          </div>

          <div class="performance-card">
            <div class="performance-value" id="memory-usage">-</div>
            <div class="performance-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (KB)</div>
          </div>
        </div>

        <button id="measure-performance" class="btn btn-info w-100 mt-3">
          –ò–∑–º–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
        </button>
      </div>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ -->
      <div class="test-section">
        <h2>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤</h2>

        <div id="test-summary" class="alert alert-secondary">
          –¢–µ—Å—Ç—ã –Ω–µ –∑–∞–ø—É—â–µ–Ω—ã. –ù–∞–∂–º–∏—Ç–µ "–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã" –¥–ª—è –Ω–∞—á–∞–ª–∞.
        </div>

        <div class="console-output" id="console-output">
          <div class="log-entry log-info">
            –ö–æ–Ω—Å–æ–ª—å –≥–æ—Ç–æ–≤–∞ –∫ –≤—ã–≤–æ–¥—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...
          </div>
        </div>
      </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/CountryFilter.js"></script>
    <script src="test_mobile_country_filter.js"></script>

    <script>
      // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
      let testInstances = {};
      let touchStats = {
        count: 0,
        responseTimes: [],
        lastTouchTime: null,
      };

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      document.addEventListener("DOMContentLoaded", function () {
        initializeTestEnvironment();
        setupEventHandlers();
        updateDeviceInfo();
        setupInteractiveTouchTest();
      });

      /**
       * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã
       */
      function initializeTestEnvironment() {
        logToConsole("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã...", "info");

        // –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
        const devices = [
          { id: "iphone-se-test", name: "iPhone SE" },
          { id: "ipad-test", name: "iPad" },
          { id: "android-phone-test", name: "Android Phone" },
          { id: "small-screen-test", name: "Small Screen" },
        ];

        devices.forEach((device) => {
          try {
            testInstances[device.id] = new CountryFilter(
              device.id,
              (countryId) => {
                logToConsole(
                  `${device.name}: –í—ã–±—Ä–∞–Ω–∞ —Å—Ç—Ä–∞–Ω–∞ ${countryId}`,
                  "success"
                );
              }
            );
            logToConsole(`${device.name}: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ`, "success");
          } catch (error) {
            logToConsole(
              `${device.name}: –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ - ${error.message}`,
              "error"
            );
          }
        });
      }

      /**
       * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
       */
      function setupEventHandlers() {
        document
          .getElementById("run-all-tests")
          .addEventListener("click", runAllTests);
        document
          .getElementById("run-mobile-adaptation")
          .addEventListener("click", () => runSpecificTest("mobile"));
        document
          .getElementById("run-touch-usability")
          .addEventListener("click", () => runSpecificTest("touch"));
        document
          .getElementById("run-loading-optimization")
          .addEventListener("click", () => runSpecificTest("loading"));
        document
          .getElementById("clear-results")
          .addEventListener("click", clearResults);
        document
          .getElementById("measure-performance")
          .addEventListener("click", measurePerformance);
      }

      /**
       * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
       */
      function updateDeviceInfo() {
        document.getElementById("user-agent").textContent =
          navigator.userAgent.substring(0, 50) + "...";
        document.getElementById("touch-support").textContent =
          "ontouchstart" in window ? "–î–∞" : "–ù–µ—Ç";
        document.getElementById(
          "screen-dimensions"
        ).textContent = `${window.innerWidth}x${window.innerHeight}`;
        document.getElementById("pixel-ratio").textContent =
          window.devicePixelRatio || 1;
      }

      /**
       * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ touch
       */
      function setupInteractiveTouchTest() {
        const touchArea = document.getElementById("interactive-touch-test");

        const handleTouch = (event) => {
          const startTime = performance.now();

          touchStats.count++;
          touchStats.lastTouchTime = new Date().toLocaleTimeString();

          // –ò–º–∏—Ç–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
          setTimeout(() => {
            const endTime = performance.now();
            const responseTime = endTime - startTime;
            touchStats.responseTimes.push(responseTime);

            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞—Å—Å–∏–≤ –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ 10 –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏
            if (touchStats.responseTimes.length > 10) {
              touchStats.responseTimes.shift();
            }

            updateTouchStats();
          }, Math.random() * 20 + 5); // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ 5-25–º—Å
        };

        // Touch —Å–æ–±—ã—Ç–∏—è
        touchArea.addEventListener("touchstart", handleTouch, {
          passive: true,
        });
        touchArea.addEventListener(
          "touchend",
          (e) => {
            e.preventDefault();
          },
          { passive: false }
        );

        // Mouse —Å–æ–±—ã—Ç–∏—è –∫–∞–∫ fallback
        touchArea.addEventListener("mousedown", handleTouch);
        touchArea.addEventListener("mouseup", (e) => {
          e.preventDefault();
        });
      }

      /**
       * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ touch
       */
      function updateTouchStats() {
        document.getElementById("touch-count").textContent = touchStats.count;
        document.getElementById("last-touch-time").textContent =
          touchStats.lastTouchTime || "-";

        if (touchStats.responseTimes.length > 0) {
          const avgTime =
            touchStats.responseTimes.reduce((a, b) => a + b, 0) /
            touchStats.responseTimes.length;
          document.getElementById("avg-response-time").textContent =
            Math.round(avgTime);
        }
      }

      /**
       * –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
       */
      async function runAllTests() {
        const button = document.getElementById("run-all-tests");
        button.disabled = true;
        button.textContent = "–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤...";

        logToConsole("–ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ —Ç–µ—Å—Ç–æ–≤...", "info");

        try {
          const tester = new MobileCountryFilterTester();
          await tester.runAllTests();

          updateTestSummary("success", "–í—Å–µ —Ç–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!");
        } catch (error) {
          logToConsole(`–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤: ${error.message}`, "error");
          updateTestSummary(
            "error",
            `–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤: ${error.message}`
          );
        } finally {
          button.disabled = false;
          button.textContent = "–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã";
        }
      }

      /**
       * –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
       */
      async function runSpecificTest(testType) {
        logToConsole(`–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞: ${testType}`, "info");

        try {
          const tester = new MobileCountryFilterTester();

          switch (testType) {
            case "mobile":
              await tester.testMobileAdaptation();
              break;
            case "touch":
              await tester.testTouchUsability();
              break;
            case "loading":
              await tester.testLoadingOptimization();
              break;
          }

          logToConsole(`–¢–µ—Å—Ç ${testType} –∑–∞–≤–µ—Ä—à–µ–Ω`, "success");
        } catch (error) {
          logToConsole(`–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞ ${testType}: ${error.message}`, "error");
        }
      }

      /**
       * –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
       */
      async function measurePerformance() {
        const button = document.getElementById("measure-performance");
        button.disabled = true;
        button.textContent = "–ò–∑–º–µ—Ä–µ–Ω–∏–µ...";

        try {
          // –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
          const initStart = performance.now();
          const testFilter = new CountryFilter(
            "performance-test-container",
            () => {}
          );
          const initEnd = performance.now();

          document.getElementById("init-time").textContent = Math.round(
            initEnd - initStart
          );

          // –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
          const firstLoadStart = performance.now();
          await testFilter.loadCountries();
          const firstLoadEnd = performance.now();

          document.getElementById("first-load-time").textContent = Math.round(
            firstLoadEnd - firstLoadStart
          );

          // –ò–∑–º–µ—Ä–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ –∫—ç—à–∞
          const cacheLoadStart = performance.now();
          await testFilter.loadCountries();
          const cacheLoadEnd = performance.now();

          document.getElementById("cache-load-time").textContent = Math.round(
            cacheLoadEnd - cacheLoadStart
          );

          // –ò–∑–º–µ—Ä–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
          if (performance.memory) {
            const memoryUsage = Math.round(
              performance.memory.usedJSHeapSize / 1024
            );
            document.getElementById("memory-usage").textContent = memoryUsage;
          }

          logToConsole("–ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–æ", "success");
        } catch (error) {
          logToConsole(
            `–û—à–∏–±–∫–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: ${error.message}`,
            "error"
          );
        } finally {
          button.disabled = false;
          button.textContent = "–ò–∑–º–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å";
        }
      }

      /**
       * –û—á–∏—Å—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
       */
      function clearResults() {
        document.getElementById("console-output").innerHTML =
          '<div class="log-entry log-info">–ö–æ–Ω—Å–æ–ª—å –æ—á–∏—â–µ–Ω–∞...</div>';

        document.getElementById("test-summary").className =
          "alert alert-secondary";
        document.getElementById("test-summary").textContent =
          "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—á–∏—â–µ–Ω—ã. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –∑–∞–Ω–æ–≤–æ.";

        // –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ touch
        touchStats = {
          count: 0,
          responseTimes: [],
          lastTouchTime: null,
        };
        updateTouchStats();

        // –°–±—Ä–æ—Å –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        [
          "init-time",
          "first-load-time",
          "cache-load-time",
          "memory-usage",
        ].forEach((id) => {
          document.getElementById(id).textContent = "-";
        });
      }

      /**
       * –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤–æ–¥–∫–∏ —Ç–µ—Å—Ç–æ–≤
       */
      function updateTestSummary(type, message) {
        const summary = document.getElementById("test-summary");

        switch (type) {
          case "success":
            summary.className = "alert alert-success";
            break;
          case "error":
            summary.className = "alert alert-danger";
            break;
          case "warning":
            summary.className = "alert alert-warning";
            break;
          default:
            summary.className = "alert alert-info";
        }

        summary.textContent = message;
      }

      /**
       * –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å
       */
      function logToConsole(message, type = "info") {
        const console = document.getElementById("console-output");
        const timestamp = new Date().toLocaleTimeString();

        const logEntry = document.createElement("div");
        logEntry.className = `log-entry log-${type}`;
        logEntry.textContent = `[${timestamp}] ${message}`;

        console.appendChild(logEntry);
        console.scrollTop = console.scrollHeight;

        // –¢–∞–∫–∂–µ –≤—ã–≤–æ–¥–∏–º –≤ –±—Ä–∞—É–∑–µ—Ä–Ω—É—é –∫–æ–Ω—Å–æ–ª—å
        switch (type) {
          case "error":
            console.error(message);
            break;
          case "warning":
            console.warn(message);
            break;
          case "success":
            console.log(`‚úÖ ${message}`);
            break;
          default:
            console.log(message);
        }
      }

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞ –∏ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏
      window.addEventListener("resize", () => {
        updateDeviceInfo();
        logToConsole(
          `–†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω: ${window.innerWidth}x${window.innerHeight}`,
          "info"
        );
      });

      window.addEventListener("orientationchange", () => {
        setTimeout(() => {
          updateDeviceInfo();
          logToConsole("–û—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞", "info");
        }, 100);
      });

      // –°–æ–∑–¥–∞–µ–º —Å–∫—Ä—ã—Ç—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
      const performanceContainer = document.createElement("div");
      performanceContainer.id = "performance-test-container";
      performanceContainer.style.display = "none";
      document.body.appendChild(performanceContainer);
    </script>
  </body>
</html>
